<!DOCTYPE html>
<html>
<head>
    <title>Firewall Monitor</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
        }
       
        .timestamp { width: 15%; }
        .ip-address { width: 10%; }
        .port { width: 5%; }
        .protocol { width: 5%; }
        .hotkey { width: 20%; }
        .action { width: 5%; }
        .reason { width: 30%; max-width: 400px; overflow-y: scroll; }
        .payload { width: 10%; max-width: 200px; overflow-y: scroll; }
    </style>
</head>
<body>
    <h1>Firewall Monitor</h1>
    <table class="table">
        <tr>
            <th class="timestamp">Timestamp</th>
            <th class="ip-address">IP Address</th>
            <th class="port">Port</th>
            <th class="protocol">Protocol</th>
            <th class="action">Hotkey</th>
            <th class="action">Action</th>
            <th class="reason">Reason</th>
            <th class="payload">Payload</th>
        </tr>
        <tbody id="events-table">
        </tbody>
    </table>
    <script>
        async function fetchEvents() {
            const response = await fetch('/events');
            const events = await response.json();
            const table = document.getElementById('events-table');
            table.innerHTML = '';
            events.forEach(event => {
                const row = document.createElement('tr');
                row.innerHTML = `<td class="timestamp">${new Date(event.timestamp * 1000).toLocaleString()}</td>
                                 <td class="ip-address">${event.ip}</td>
                                 <td class="port">${event.port}</td>
                                 <td class="protocol">${event.protocol}</td>
                                 <td class="protocol">${event.hotkey}</td>
                                 <td class="action">${event.action}</td>
                                 <td class="reason">${event.reason || ''}</td>
                                 <td class="payload">${event.payload || ''}</td>`;
                table.appendChild(row);
            });
        }

        setInterval(fetchEvents, 1000);
        fetchEvents();
    </script>
</body>
</html>